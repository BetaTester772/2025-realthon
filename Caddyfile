{
    email hoseong8115.dev@gmail.com
}

realthon.betatester772.dev {

    header {
        X-Content-Type-Options "nosniff"
        X-Frame-Options "DENY"
        Referrer-Policy "no-referrer-when-downgrade"
        Permissions-Policy "geolocation=(), microphone=(), camera=()"
        Strict-Transport-Security "max-age=31536000; includeSubDomains"
    }

    @blocked path \
        /.env /.env/* \
        /.git /.git/* \
        /admin /admin/* \
        /wp-admin /wp-admin/* \
        /phpmyadmin /phpmyadmin/* \
        /cgi-bin /cgi-bin/* \
        /server-status /server-status/* \
        /*.php

    handle @blocked {
        respond 403
    }

    handle {
        reverse_proxy app:8000 {
            health_uri /health
            health_interval 10s
            health_timeout 5s

            header_up Host {host}
            header_up X-Real-IP {remote_host}
            header_up X-Forwarded-For {remote_host}
            header_up X-Forwarded-Proto {scheme}
        }
    }

    encode gzip

    log {
        output file /var/log/caddy/access.log
        format json
    }
}